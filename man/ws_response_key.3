.\" Automatically generated by Pandoc 1.19.2.4
.\"
.TH "WS_RESPONSE_KEY" "3" "" "libdill" "libdill Library Functions"
.hy
.SH NAME
.PP
ws_response_key \- generates a WebSocket response key for a given
request key
.SH SYNOPSIS
.IP
.nf
\f[C]
#include\ <libdill.h>

int\ ws_response_key(
\ \ \ \ const\ char*\ request_key,
\ \ \ \ char*\ response_key);
\f[]
.fi
.SH DESCRIPTION
.PP
\f[B]WARNING: This is experimental functionality and the API may change
in the future.\f[]
.PP
WebSocket is a message\-based protocol defined in RFC 6455.
It can be used as a bidirectional communication channel for
communication with a web server.
.PP
This is a helper function that can be used when doing a custom HTTP
handshake for the WebSocket protocol (see \f[B]WS_NOHTTP\f[] flag).
On the server, it can be used to generates an RFC\-compliant response
key, to be filled into \f[B]Sec\-WebSocket\-Accept\f[] field, for a
request key received from the client.
On the client side, it can be used to verify that the response key
received from the server is correct.
.PP
The generated key is null\-terminated.
.PP
\f[B]request_key\f[]: The request key, as passed in
\f[B]Sec\-WebSocket\-Key\f[] field.
.PP
\f[B]response_key\f[]: Buffer to hold the generated response key.
It must be at least \f[B]WS_KEY_SIZE\f[] bytes long.
.PP
This function is not available if libdill is compiled with
\f[B]\-\-disable\-sockets\f[] option.
.SH RETURN VALUE
.PP
In case of success the function returns 0.
In case of error it returns \-1 and sets \f[B]errno\f[] to one of the
values below.
.SH ERRORS
.IP \[bu] 2
\f[B]EINVAL\f[]: Invalid argument.
.IP \[bu] 2
\f[B]EPROTO\f[]: Supplied request key is not RFC 6455 compliant.
.SH EXAMPLE
.IP
.nf
\f[C]
char\ name[256];
char\ value[256];
http_recvfield(s,\ name,\ sizeof(name),\ value,\ sizeof(value),\ \-1);
assert(strcasecmp(name,\ "Sec\-WebSocket\-Key")\ ==\ 0);
ws_response_key(value,\ response_key);
http_sendfield(s,\ "Sec\-WebSocket\-Accept",\ response_key,\ \-1);
\f[]
.fi
.SH SEE ALSO
.PP
\f[B]mrecv\f[](3) \f[B]mrecvl\f[](3) \f[B]msend\f[](3)
\f[B]msendl\f[](3) \f[B]ws_attach_client\f[](3)
\f[B]ws_attach_client_mem\f[](3) \f[B]ws_attach_server\f[](3)
\f[B]ws_attach_server_mem\f[](3) \f[B]ws_detach\f[](3)
\f[B]ws_done\f[](3) \f[B]ws_recv\f[](3) \f[B]ws_recvl\f[](3)
\f[B]ws_request_key\f[](3) \f[B]ws_send\f[](3) \f[B]ws_sendl\f[](3)
\f[B]ws_status\f[](3)
