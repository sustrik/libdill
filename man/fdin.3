.\" Automatically generated by Pandoc 1.19.2.4
.\"
.TH "FDIN" "3" "" "libdill" "libdill Library Functions"
.hy
.SH NAME
.PP
fdin \- waits on a file descriptor to become readable
.SH SYNOPSIS
.IP
.nf
\f[C]
#include\ <libdill.h>

int\ fdin(
\ \ \ \ int\ fd,
\ \ \ \ int64_t\ deadline);
\f[]
.fi
.SH DESCRIPTION
.PP
Waits on a file descriptor (true OS file descriptor, not libdill socket
handle) to either become readable or get into an error state.
Either case leads to a successful return from the function.
To distinguish the two outcomes, follow up with a read operation on the
file descriptor.
.PP
\f[B]fd\f[]: file descriptor (OS\-level one, not a libdill handle)
.PP
\f[B]deadline\f[]: A point in time when the operation should time out,
in milliseconds.
Use the \f[B]now\f[] function to get your current point in time.
0 means immediate timeout, i.e., perform the operation if possible or
return without blocking if not.
\-1 means no deadline, i.e., the call will block forever if the
operation cannot be performed.
.SH RETURN VALUE
.PP
In case of success the function returns 0.
In case of error it returns \-1 and sets \f[B]errno\f[] to one of the
values below.
.SH ERRORS
.IP \[bu] 2
\f[B]EBADF\f[]: Not a file descriptor.
.IP \[bu] 2
\f[B]EBUSY\f[]: Another coroutine already blocked on \f[B]fdin\f[] with
this file descriptor.
.IP \[bu] 2
\f[B]ECANCELED\f[]: Current coroutine was canceled.
.IP \[bu] 2
\f[B]ETIMEDOUT\f[]: Deadline was reached.
.SH EXAMPLE
.IP
.nf
\f[C]
int\ result\ =\ fcntl(fd,\ F_SETFL,\ O_NONBLOCK);
assert(result\ ==\ 0);
while(1)\ {
\ \ \ \ result\ =\ fdin(fd,\ \-1);
\ \ \ \ assert(result\ ==\ 0);
\ \ \ \ char\ buf[1024];
\ \ \ \ ssize_t\ len\ =\ recv(fd,\ buf,\ sizeof(buf),\ 0);
\ \ \ \ assert(len\ >\ 0);
\ \ \ \ process_input(buf,\ len);
}
\f[]
.fi
.SH SEE ALSO
.PP
\f[B]fdclean\f[](3) \f[B]fdout\f[](3) \f[B]now\f[](3)
